name: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è person.txt –∏–∑ make_person.py

on:
  workflow_dispatch:
  push:
    branches: [main]
  schedule:
    - cron: '0 21 * * *' # –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 00:00 –ø–æ –ú–∏–Ω—Å–∫—É (UTC+3)

jobs:
  generate-person:
    runs-on: ubuntu-latest

    steps:
    - name: üì• –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
      uses: actions/checkout@v3

    - name: üêç –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Python
      run: sudo apt update && sudo apt install python3 -y

    - name: üöÄ –ó–∞–ø—É—Å–∫–∞–µ–º make_person.py
      run: python3 make_person.py

    - name: üìÇ –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ person.txt
      run: |
        if [ ! -f person.txt ]; then
          echo "‚ùå –§–∞–π–ª person.txt –Ω–µ –Ω–∞–π–¥–µ–Ω!"
          exit 1
        fi

    - name: üìÑ –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ person.txt
      run: cat person.txt

    - name: ‚öôÔ∏è –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º Git
      run: |
        git config user.name "github-actions"
        git config user.email "github-actions@github.com"

    - name: üì§ –î–æ–±–∞–≤–ª—è–µ–º –∏ –ø—É—à–∏–º person.txt (–µ—Å–ª–∏ –∏–∑–º–µ–Ω–∏–ª—Å—è)
      run: |
        git add person.txt
        if git diff --cached --quiet; then
          echo "üü° –ù–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ person.txt ‚Äî –∫–æ–º–º–∏—Ç –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è"
        else
          git commit -m "‚úÖ –û–±–Ω–æ–≤–ª—ë–Ω person.txt"
          git push
        fi
