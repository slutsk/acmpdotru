name: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ –ø—É–±–ª–∏–∫–∞—Ü–∏—è index.html

on:
  workflow_dispatch:
  push:
    branches: [main]
  schedule:
    - cron: '0 21 * * *' # –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 00:00 –ø–æ –ú–∏–Ω—Å–∫—É

jobs:
  build-run-deploy:
    runs-on: ubuntu-latest

    steps:
    - name: üì• –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
      uses: actions/checkout@v3

    - name: üêç –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Python
      run: sudo apt update && sudo apt install python3 -y

    - name: üöÄ –ó–∞–ø—É—Å–∫–∞–µ–º make_person.py
      run: python3 make_person.py

    - name: üìÇ –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ person.txt
      run: |
        if [ ! -f person.txt ]; then
          echo "‚ùå –§–∞–π–ª person.txt –Ω–µ –Ω–∞–π–¥–µ–Ω!"
          exit 1
        fi

    - name: üõ† –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä C++
      run: sudo apt install g++ -y

    - name: üß± –ö–æ–º–ø–∏–ª–∏—Ä—É–µ–º make_html.cpp
      run: g++ make_html.cpp -o make_html

    - name: üßæ –ó–∞–ø—É—Å–∫–∞–µ–º make_html
      run: ./make_html

    - name: üìÇ –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ public/index.html
      run: |
        if [ ! -f public/index.html ]; then
          echo "‚ùå –§–∞–π–ª index.html –Ω–µ –Ω–∞–π–¥–µ–Ω!"
          exit 1
        fi

    - name: üåê –ü—É–±–ª–∏–∫—É–µ–º –Ω–∞ GitHub Pages
      uses: peaceiris/actions-gh-pages@v3
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}
        publish_dir: ./public

