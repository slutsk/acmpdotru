name: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è index.html –∏–∑ Python –∏ C++

on:
  workflow_dispatch: # –∑–∞–ø—É—Å–∫ –≤—Ä—É—á–Ω—É—é
  push:
    branches: [main] # –∑–∞–ø—É—Å–∫ –ø—Ä–∏ –ø—É—à–µ –≤ main

jobs:
  build-run-save:
    runs-on: ubuntu-latest

    steps:
    - name: üì• –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
      uses: actions/checkout@v3

    - name: üêç –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Python
      run: sudo apt update && sudo apt install python3 -y

    - name: üöÄ –ó–∞–ø—É—Å–∫–∞–µ–º make_person.py
      run: python3 make_person.py

    - name: üìÇ –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ person.txt
      run: |
        if [ ! -f person.txt ]; then
          echo "‚ùå –§–∞–π–ª person.txt –Ω–µ –Ω–∞–π–¥–µ–Ω!"
          exit 1
        fi

    - name: üõ† –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä C++
      run: sudo apt install g++ -y

    - name: üß± –ö–æ–º–ø–∏–ª–∏—Ä—É–µ–º make_html.cpp
      run: g++ make_html.cpp -o make_html

    - name: üßæ –ó–∞–ø—É—Å–∫–∞–µ–º make_html
      run: ./make_html

    - name: üìÇ –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ index.html
      run: |
        if [ ! -f index.html ]; then
          echo "‚ùå –§–∞–π–ª index.html –Ω–µ –Ω–∞–π–¥–µ–Ω!"
          exit 1
        fi

    - name: üìÑ –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ index.html
      run: cat index.html

    - name: ‚öôÔ∏è –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º Git
      run: |
        git config user.name "github-actions"
        git config user.email "github-actions@github.com"

    - name: üì§ –î–æ–±–∞–≤–ª—è–µ–º –∏ –ø—É—à–∏–º index.html (–µ—Å–ª–∏ –∏–∑–º–µ–Ω–∏–ª—Å—è)
      run: |
        git add index.html
        if git diff --cached --quiet; then
          echo "üü° –ù–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ index.html ‚Äî –∫–æ–º–º–∏—Ç –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è"
        else
          git commit -m "‚úÖ –û–±–Ω–æ–≤–ª—ë–Ω index.html"
          git push
        fi
